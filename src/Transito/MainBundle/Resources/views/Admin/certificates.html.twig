{% extends "TransitoMainBundle:Admin:layout.html.twig" %}
{% use "TransitoMainBundle:Admin:form.inc.twig" %}
{% set title = 'Tramites a certificar' %}
{% set page_title = title %}
{% set page_subtitle = title %}
{% block page_content %}
    <div class="row">
        <div class="col-md-12">
            <!-- start: TABLE WITH IMAGES PANEL -->
            <div class="panel panel-white">
                <div class="panel-body">
                    {% if errors is not empty %}
                        <div class="alert alert-block alert-danger fade in">
                            <button data-dismiss="alert" class="close" type="button">
                                &times;
                            </button>
                            <h4 class="alert-heading"><i class="fa fa-times"></i> Error!</h4>
                            {% for error in errors %}
                                <p>{{ error.message }}</p>
                            {% endfor %}
                        </div>
                    {% endif %}
                    <form method="POST" action="{{ path('certificate_list_page') }}" role="form" class="form-horizontal">
                        <div class="form-group">
                            <label class="col-sm-1 control-label" for="{{ form.date.vars.id }}">
                                Fecha
                            </label>
                            <div class="col-sm-3">
                                <div class="input-group">
                                    <input type="text" name="{{ form.date.vars.full_name }}" id="{{ form.date.vars.id }}" value="{{ (form.vars.value is not empty ) ? form.vars.value.date : '' }}" data-date-format="dd-mm-yyyy" data-date-viewmode="years" class="form-control date-picker">
                                    <span class="input-group-addon"> <i class="fa fa-calendar"></i> </span>
                                </div>

                            </div>
                            <label class="col-sm-1 control-label">
                                DNI
                            </label>
                            <div class="col-sm-3" for="{{ form.dni.vars.id }}">
                                <input type="text" name="{{ form.dni.vars.full_name }}" id="{{ form.dni.vars.id }}" value="{{ (form.vars.value is not empty ) ? form.vars.value.dni : '' }}" class="form-control">
                            </div>
                            <label class="col-sm-1 control-label">
                                Nombre
                            </label>
                            <div class="col-sm-3" for="{{ form.name.vars.id }}">
                                <input type="text" name="{{ form.name.vars.full_name }}" id="{{ form.name.vars.id }}" value="{{ (form.vars.value is not empty ) ? form.vars.value.name : '' }}" class="form-control">
                            </div>
                        </div>
                        <br />
                        <div class="form-group"><div class="col-sm-12"><input type="submit" value="Ver tramites" class="btn btn-blue btn-block"></div></div>
                                {{ form_widget(form._token) }}
                    </form>
                    <br />
                    <table class="table table-striped table-hover" id="sample-table-2">
                        <thead>
                            <tr>
                                <th># Factura</th>
                                <th>DNI</th>
                                <th>Nombre</th>
                                <th>Fecha</th>
                                <th>Estado</th>
                                <th class="center">Certificar</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for procedure in procedures %}
                                <tr>
                                    <td>{{ procedure.getBill() }}</td>
                                    <td>{{ procedure.getDni() }}</td>
                                    <td>{{ procedure.getName() }}</td>
                                    <td>{{ procedure.getDate() }}</td>

                                    <td>{{ (procedure.getSpeechTherapy() and procedure.getPsychological() and procedure.getPhysical() and procedure.getOptometry()) ? 'Listo para certificar' : 'En proceso' }}</td>
                                    <td class="center">
                                        <a href="{{ path('certificate_page', {'bill': procedure.getBill()}) }}" class="btn btn-xs btn-red tooltips" data-placement="top" data-original-title="Certificar">
                                            <i class="fa fa-arrow-circle-right"></i>
                                        </a>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- end: TABLE WITH IMAGES PANEL -->
            <br />
        </div>
    </div>
{% endblock %}